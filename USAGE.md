# @ksa.obj
カスタムオブジェクト用のスクリプトです．

## 折れ線矢印
本家の「ライン(移動軌跡)」のように長さを時間変化させるための折れ線矢印です．長さは折れ線全体の長さに対するパーセンテージを「描画率」のパラメータで調整します．「ライン(移動軌跡)」が鏃の中心を軸にしているのに対し，「折れ線矢印」は鏃の先端を軸にしているため，特定の座標を指したいときに使いやすいです．代わりに，折れる途中の描画が手抜きで汚いです．

<dl>
 <dt>線幅</dt>
  <dd>線の幅をピクセル数で指定します．</dd>
 <dt>鏃長</dt>
  <dd>鏃の長さを線幅に対するパーセンテージで指定します．</dd>
 <dt>鏃幅</dt>
  <dd>鏃の幅を線幅に対するパーセンテージで指定します．</dd>
 <dt>描画率</dt>
  <dd>折れ線全体に対して描画するパーセンテージを指定します．特定の頂点までのパーセンテージは別途計算の必要があります．</dd>
 <dt>色</dt>
  <dd>線の色を指定します．</dd>
 <dt>頂点数</dt>
  <dd>頂点数を2～16の範囲で指定します．頂点はアンカーポイントになっており，ドラッグで動かせます．</dd>
 <dt>座標</dt>
  <dd><code>{頂点1のx, 頂点1のy, 頂点2のx, ...}</code>の形で座標を指定します．アンカーポイントで動かす場合は気にしなくて大丈夫です．</dd>
</dl>

## 矩形枠
「角度」が`0`の場合に，各辺がx軸またはy軸に平行な長方形の枠です．

<dl>
 <dt>線幅</dt>
  <dd>線の幅をピクセル数で指定します．</dd>
 <dt>角丸</dt>
  <dd><code>1</code>なら角を丸くし，<code>0</code>なら尖らせます．丸みの半径は線幅の半分で固定です．</dd>
 <dt>アンカー数</dt>
  <dd><code>2</code>なら対角線上の2頂点を，<code>1</code>なら1頂点をアンカーポイントとします．角度を変える場合は<code>1</code>にするとアンカーポイントと描画頂点がずれません．</dd>
 <dt>色</dt>
  <dd>線の色を指定します．</dd>
 <dt>座標</dt>
  <dd>アンカーポイントの座標が出力されます．数字を指定して頂点位置を決めてもよいです．</dd>
</dl>

## 楕円枠
アンカーポイントで生成される長方形に沿った楕円形の枠です．

<dl>
 <dt>線幅</dt>
  <dd>線の幅をピクセル数で指定します．</dd>
 <dt>アンカー数</dt>
  <dd><code>2</code>なら対角線上の2頂点を，<code>1</code>なら1頂点をアンカーポイントとします．角度を変える場合は<code>1</code>にするとアンカーポイントと描画頂点がずれません．</dd>
 <dt>タイプ</dt>
  <dd><code>0</code>なら自然な楕円枠を，<code>1</code>なら折れ線近似した等幅の枠を描画します．</dd>
 <dt>分割数</dt>
  <dd>タイプ<code>1</code>における折れ点の数を指定します．タイプ<code>0</code>の場合は無視されます．</dd>
 <dt>色</dt>
  <dd>線の色を指定します．</dd>
 <dt>座標</dt>
  <dd>アンカーポイントの座標が出力されます．数字を指定して頂点位置を決めてもよいです．</dd>
</dl>


## 枠付き角丸四角形
角を丸められ，枠と塗りつぶし領域で独立に色や透明度を調整できる長方形オブジェクトです．

<dl>
 <dt>角半径</dt>
  <dd>角を丸くする場合の外径半径をピクセル数で指定します．長方形の短辺の長さより大きく指定しても，短辺の長さになります．<code>0</code>なら尖ります．</dd>
 <dt>枠太さ</dt>
  <dd>枠線の太さをピクセル数で指定します．長方形の短辺の長さより大きく指定すると，全体が枠になります．<code>0</code>なら枠なしです．</dd>
 <dt>枠透明度<dt>
  <dd>枠線の透明度を指定します．0: 完全不透明，100: 完全透明．</dd>
 <dt>内透明度</dt>
  <dd>塗りつぶし領域の透明度を指定します．0: 完全不透明，100: 完全透明．</dd>
 <dt>内色</dt>
  <dd>塗りつぶしの色を指定します．</dd>
 <dt>枠色</dt>
  <dd>枠線の色を指定します．</dd>
 <dt>シングルアンカー</dt>
  <dd>未チェックなら対角線上の2頂点を，チェックなら1頂点をアンカーポイントとします．角度を変える場合はチェックするとアンカーポイントと描画頂点がずれません．</dd>
 <dt>座標</dt>
  <dd>アンカーポイントの座標が出力されます．アンカーポイントは外径を決定します．</dd>
</dl>

## インターレース解除
インターレース解除をしながら動画を読み込むオブジェクトです．アニメーション効果にも同じスクリプトがあります．
正常に動作させるには，プロジェクトのフレームレートを入力動画の 2 倍にする必要があります．
分割や倍速再生などはシーンを使ってください．

<dl>
 <dt>解除法</dt>
  <dd>インターレース解除のアルゴリズムを選択します．数値とアルゴリズムの対応は下の表のとおりです．</dd>
 <dt>BFF/TFF</dt>
  <dd>フィールドオーダーを指定します．<code>0</code>ならボトムフィールドファースト，<code>1</code>ならトップフィールドファーストとしてインターレース解除します．</dd>
 <dt>スレッド数</dt>
  <dd>マルチスレッド処理に使うスレッド数を指定します．0 以下の値なら論理コア数+指定値 (これも0以下なら1) とします．論理コア数以上を指定した場合，論理コア数に修正されます．</dd>
 <dt>ファイル</dt>
  <dd>入力動画のファイルへのパスを指定します．</dd>
</dl>

|数値|アルゴリズム|
|:---|:---|
|`0`|インターレース解除なし|
|`1`|240p 用の補間なしの解除|
|`2`|空間方向補間 (フィールド補間，bob)|
|`3`|時間方向補間|
|`4`|時間方向補間 with 二重化|

240p の疑似インターレース動画には`1`を使用します．480i などのインターレース動画では，チラツキはあるがゴーストのない`2`か，ゴーストが出てぼやけるが滑らかな`4`を使用します．

拡張編集 0.93rc1 の環境下において，シーン内で解除法`3`または`4`を使用し，root シーンから読み込もうとするとクラッシュします．これは拡張編集側のバグであるため，拡張編集 0.92 を使用してください．

# @ksa.anm
アニメーション効果用のスクリプトです．

## 透明度グラデーション
高透明度側と低透明度側の透明度を任意に指定できる透明度グラデーションです．

<dl>
 <dt>中心X，中心Y</dt>
  <dd>グラデーションの斜め線の中心点の座標です．</dd>
 <dt>角度</dt>
  <dd>グラデーションの斜め線の角度(度)です．</dd>
 <dt>幅</dt>
  <dd>グラデーションをかける幅をピクセル数で指定します．</dd>
 <dt>開始透明度，終了透明度</dt>
  <dd>グラデーション前後の透明度を指定します．透明度を逆にするのと「角度」を<code>180</code>ずらすのは同じ効果です．0 が透明度変化なし，100 が完全透明を意味します．</dd>
 <dt>タイプ</dt>
  <dd><code>0</code>なら線形状，<code>1</code>ならsinカーブ状のグラデーションを掛けます．</dd>
</dl>

## 縁透明グラデーション
長方形のオブジェクトの縁に透明度のグラデーションを掛け，背景に馴染むようにする効果です．

<dl>
 <dt>幅</dt>
  <dd>縁から何 px に亘ってグラデーションを掛けるかを指定します．</dd>
 <dt>角丸</dt>
  <dd><code>1</code>なら角を丸くします．</dd>
 <dt>タイプ</dt>
  <dd><code>0</code>なら線形状，<code>1</code>なら円状のグラデーションを掛けます．</dd>
 <dt>追加上，追加下，追加左，追加右</dt>
  <dd>上下左右の幅を追加します．向きによって異なる幅にしたいときに指定します．</dd>
</dl>

## 回転
「広がって登場」をずっと繰り返すようなアニメーションです．
仮想バッファ利用がうまく行かず，直接描画しているので，最後のエフェクトにする必要があります．

<dl>
 <dt>回転量</dt>
  <dd>回転の回数を，半回転の何倍かで指定します．<code>1</code>なら広がって登場してそのまま縮まって退場します．</dd>
 <dt>縦回転</dt>
  <dd><code>0</code>ならY軸回転，<code>1</code>ならX軸回転に近い動きをします (縦または横に拡大縮小しているだけであり，カメラ制御との組み合わせは想定していません)．</dd>
 <dt>反転</dt>
  <dd>回転を逆方向にします．</dd>
</dl>

## Lanczos3リサイズ
Lanczos3 関数を使ったリサイジンクを行います．
マルチスレッド処理をしますが，それでも非常に重いので，使用時はご留意ください．

<dl>
 <dt>拡大率，X，Y</dt>
  <dd>横を (拡大率×X)/1e4 倍，縦を (拡大率×Y)/1e4 倍します．</dd>
 <dt>ドット数でサイズ指定</dt>
  <dd>出力サイズを X×Y にし，拡大率を無視します．</dd>
 <dt>スレッド数</dt>
  <dd>マルチスレッド処理を行う際のスレッド数を指定します．<code>0</code>以下の値を指定すると max(CPUスレッド数+指定値, 1) 個のスレッドを使います．</dd>
 <dt>上，下，左，右</dt>
  <dd>リサイズ前に指定したピクセル数のクリッピングを行います．</dd>
</dl>

## クリッピング&倍角化
Lanczos3リサイズの倍化専用版．ただしそれほど速くならない．

## インターレース解除
カスタムオブジェクトの「インターレース解除」と同じスクリプトです．適用対象のオブジェクトを無視して，ファイル入力の動画をインターレース解除した画像にします．

# @ksa.tra
トラックバー変化方法用のスクリプトです．

## 加減速移動
本家の加減速移動がバグっているので追加した加減速移動スクリプト．
パラメータの値 (デフォルト：`5`) によって，次の多項式に比例した形で変化させます．

|パラメータ|式|満たす条件|
|:-|:-|:-|
|`0`|<img src="https://latex.codecogs.com/gif.latex?x^2(3-2x)" title="x^2(3-2x)" />|速度が連続|
|`1`|<img src="https://latex.codecogs.com/gif.latex?x^3(10&plus;3x(-5&plus;2x)))" title="x^3(10+3x(-5+2x)))" />|加速度が連続|
|`2`|<img src="https://latex.codecogs.com/gif.latex?x^4(35-2x(42&plus;5x(-7&plus;2x)))))" title="x^4(35-2x(42+5x(-7+2x)))))" />|躍度が連続|
|`3`|<img src="https://latex.codecogs.com/gif.latex?\big(\!\sin(\pi&space;x/2)\big)^2" title="\big(\!\sin(\pi x/2)\big)^2" />|速度が連続|
|`4`|<img src="https://latex.codecogs.com/gif.latex?x-\tfrac{\sin(2\pi&space;x)}{2\pi}" title="x-\tfrac{\sin(2\pi x)}{2\pi}" />|加速度が連続|
|`5`|<img src="https://latex.codecogs.com/gif.latex?\big(2&plus;\cos(\pi&space;x)\big)\big(\!\sin(\pi&space;x/2)\big)^4" title="\big(2+\cos(\pi x)\big)\big(\!\sin(\pi x/2)\big)^4" />|躍度が連続|
|`6`|<img src="https://latex.codecogs.com/gif.latex?\begin{cases}&space;\&space;2x^2&space;&&space;0\leq&space;x&space;<&space;1/2&space;\\&space;\&space;-1-2(-2&plus;x)&space;x&space;&&space;1/2\leq&space;x&space;\leq&space;1&space;\end{cases}" title="\begin{cases} \ 2x^2 & 0\leq x < 1/2 \\ \ -1-2(-2+x) x & 1/2\leq x \leq 1 \end{cases}" />|速度が連続|

「速度が連続」＜「加速度が連続」＜「躍度が連続」の順になめらかになっていき，滑らかさでない順に並べると`6`<`0`<`3`<`1`<`4`<`2`<`5`となります．
